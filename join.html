<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Level Up Series ‚Äì Registration</title>
  <link rel="stylesheet" href="../styles/form.css">
<!-- <style>
  body, html {
    height: 100%;
    margin: 0;
    font-family: Arial, sans-serif;
    display: flex;
    justify-content: center;
    align-items: center;
    background: #f0f0f0; /* optional page background */
  }

  .message-box {
    padding: 30px 50px;
    text-align: center;
    color: #fff;
    font-size: 1.2rem;
    font-weight: bold;
    border-radius: 15px;
    background: linear-gradient(135deg, #a3b18a, #588157);
    box-shadow: 0 10px 20px rgba(0,0,0,0.2);
  }
     @media (max-width: 600px) {
      .message-box {
        padding: 20px 10px;
      }
   }
</style> -->
</head>
<body>

<!-- <div class="message-box">
    <p>Program entry is closed. Registration is no longer available.</p>
</div> -->

    <!-- Payment Section -->
     <section id="paymentSection">
      <div class="payment-section">
        <h2>Form for previous month‚Äôs participants</h2>

        <!-- Program Selection -->
        <div class="program-options">
          <label class="program-card">
            <input type="radio" name="program" value="299" data-name="  previou-participants-Level-Up Essentials" checked>
            Level-Up Essentials<br>(‚Çπ299)
          </label>
          <label class="program-card">
            <input type="radio" name="program" value="299" data-name=" previou-participants-Level-Up Intensive">
            Level-Up Intensive<br>(‚Çπ299)
          </label>
        </div>

         <!-- Bank Transfer Info -->
        <p>Please make the payment to the following bank account:</p>
         <div class="bank-details" style="margin:15px 0; padding:15px; border:1px solid #ccc; border-radius:10px; background:#f9f9f9;">
          <p>
            <strong>Account Number:</strong> 
            <span id="accountNumber">42364460586</span>
            <button class="copy-btn" data-copy-target="accountNumber">Copy</button>
          </p>
          <p>
            <strong>IFSC Code:</strong> 
            <span id="ifscCode">SBIN0070199</span>
            <button class="copy-btn" data-copy-target="ifscCode">Copy</button>
          </p>
          <p><strong>Bank:</strong> State Bank of India</p>
        </div>
        <p class="hint"><strong>After your payment, click the "Done Payment" button below.</strong></p>

        <!-- Fee Display -->
        <p id="feeDisplay" class="fee-display"></p>

        <p class="note">‚ö†Ô∏è First pay to this, then fill the form below.  
        Provide either the <strong>payment screenshot</strong> OR <strong>Transaction ID</strong>.</p>

        <!-- Done Payment Button -->
        <button id="doneBtn" class="done-btn">‚úÖ Done Payment</button>
      </div>
    </section>

    <!-- Registration Form Section -->
    <!-- Registration Form Section -->
  <section>
    <div class="form-container" id="formContainer">
      <h2>Register Now</h2>
      <form id="regForm">
        <input type="text" placeholder="Name*" required>
        <input type="number" placeholder="Age*" required>
        <input type="tel" placeholder="Phone Number*" required>
        <input type="email" placeholder="Email*" required>

        <!-- readonly program field -->
        <input id="programInput" type="text" placeholder="Selected Program*" readonly required>

        <input type="text" placeholder="Instagram ID*" required>


        <!-- Screenshot or Transaction ID -->
        <div class="payment-proof">
          <p>Upload screenshot of payment done OR provide Transaction ID of payment</p>
          <div class="payment-row">
            <div id="screenshotWrapper">
              <input type="file" id="screenshot" accept="image/*">
              <div id="screenshotPreview" style="display: none; position: relative; margin-top: 10px;">
                <img id="previewImg" src="" alt="Screenshot Preview" 
                    style="width: 100%; height: 100%; object-fit: cover; border-radius: 10px; border: 2px solid #ccc; padding: 5px;">
                <button id="deleteScreenshot" 
                        style="position: absolute; top: -20px; right: -20px; background: #e63946; color: white; border: none; border-radius: 50%; width: 25px; height: 25px; cursor: pointer; display:flex; justify-content: center; align-items: center; font-size: 20px;">√ó</button>
              </div>
            </div>
            <input type="text" id="txnId" placeholder="Transaction ID">
          </div>
        </div>
        <button type="submit">Submit</button>
      </form>

      <!-- Back to Payment Button -->
      <button id="backToPaymentBtn" 
              style="margin-top:15px; padding:12px 20px; background:#555; color:white; border:none; border-radius:10px; cursor:pointer;">
        üîô Back to Payment
      </button>
    </div>
  </section>

<!-- Loader -->
<div id="loader" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; 
     background:rgba(0,0,0,0.5);  justify-content:center; align-items:center; z-index:9999;">
  <div style="border: 8px solid #f3f3f3; border-top: 8px solid #588157; border-radius:50%; width:60px; height:60px; animation: spin 1s linear infinite;"></div>
</div>

<!-- Success Message -->
<div id="successMessage">
  <h2>‚úÖ Your request has been successfully submitted!</h2>
  <p>Our team will connect with you through WhatsApp shortly.</p>
  <button id="closeSuccess">OK</button>
</div>

<style>
@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}
</style>

<script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
<script>
   (function() {
      emailjs.init("H5O8Mnk_IWGOAkzyq"); // ‚ö†Ô∏è Replace with your actual Public Key
   })();
</script>



  <script>
    // const qrCode = document.getElementById("qrCode");
    const feeDisplay = document.getElementById("feeDisplay");
    const programOptions = document.querySelectorAll(".program-card input");
    // const upiId = document.getElementById("upiId").innerText;
    const programInput = document.getElementById("programInput");

    const screenshot = document.getElementById("screenshot");
    const txnId = document.getElementById("txnId");

    const paymentSection = document.getElementById("paymentSection");
    const formContainer = document.getElementById("formContainer");
    const doneBtn = document.getElementById("doneBtn");

    let selectedAmount = null;

    // Handle program selection
    programOptions.forEach(option => {
      option.addEventListener("change", () => {
        updateProgram(option);
      });
    });

function updateProgram(option) {
  selectedAmount = option.value;
  const programName = option.getAttribute("data-name");

  // Update fee display and readonly input
  feeDisplay.textContent = "Fee: ‚Çπ" + selectedAmount;
  programInput.value = programName + " (‚Çπ" + selectedAmount + ")";

  // Highlight selected card
  document.querySelectorAll(".program-card").forEach(card => card.classList.remove("selected"));
  option.parentElement.classList.add("selected");

  // üî• Update URL param without reload
  const programSlug = (selectedAmount === "299") ? "essentials" : "intensive";
  const newUrl = `${window.location.pathname}?program=${programSlug}`;
  history.replaceState(null, "", newUrl);
}



    // Default select Essentials program on load
    // const defaultOption = document.querySelector('.program-card input:checked');
    // if (defaultOption) {
    //   updateProgram(defaultOption);
    // }

    // Copy UPI with button state change
    // const copyBtn = document.getElementById("copyBtn");
    // const upiText = document.getElementById("upiText");
    // copyBtn.addEventListener("click", () => {
    //   navigator.clipboard.writeText(upiText.value).then(() => {
    //     copyBtn.textContent = "Copied";
    //     copyBtn.disabled = true;
    //     setTimeout(() => {
    //       copyBtn.textContent = "Copy";
    //       copyBtn.disabled = false;
    //     }, 3000);
    //   }).catch(err => console.error("Copy failed", err));
    // });

    // Show form when payment done
    doneBtn.addEventListener("click", () => {
      paymentSection.style.display = "none";
      formContainer.style.display = "block";
    });

    // Screenshot + Transaction ID logic
    const screenshotPreview = document.getElementById("screenshotPreview");
    const previewImg = document.getElementById("previewImg");
    const deleteScreenshot = document.getElementById("deleteScreenshot");

    screenshot.addEventListener("change", () => {
      if (screenshot.files && screenshot.files[0]) {
        const reader = new FileReader();
        reader.onload = (e) => {
          previewImg.src = e.target.result;
          screenshotPreview.style.display = "block";
          screenshot.style.display = "none";
          txnId.style.display = "none";
        };
        reader.readAsDataURL(screenshot.files[0]);
      }
    });

    deleteScreenshot.addEventListener("click", () => {
      screenshot.value = "";
      screenshotPreview.style.display = "none";
      screenshot.style.display = "block";
      txnId.style.display = "block";
    });

    txnId.addEventListener("input", () => {
      if (txnId.value.trim() !== "") {
        screenshotWrapper.style.display = "none";
      } else {
        screenshotWrapper.style.display = "block";
      }
    });

const loader = document.getElementById("loader");
const successMessage = document.getElementById("successMessage");
const closeSuccess = document.getElementById("closeSuccess");

document.getElementById("regForm").addEventListener("submit", async (e) => {
  e.preventDefault();

  if (txnId.value.trim() === "" && screenshot.files.length === 0) {
    alert("Please provide either Transaction ID or Payment Screenshot.");
    return;
  }

  // Show loader
  loader.style.display = "flex";

  // Convert image to Base64 if provided
  let photoBase64 = "";
  let photoName = "";
  if (screenshot.files.length > 0) {
    const file = screenshot.files[0];
    photoName = file.name;
    const reader = new FileReader();
    photoBase64 = await new Promise((resolve) => {
      reader.onload = () => resolve(reader.result);
      reader.readAsDataURL(file);
    });
  }

  const formData = {
    name: document.querySelector('input[placeholder="Name*"]').value,
    age: document.querySelector('input[placeholder="Age*"]').value,
    phone: document.querySelector('input[placeholder="Phone Number*"]').value,
    email: document.querySelector('input[placeholder="Email*"]').value,
    program: programInput.value,
    instagram: document.querySelector('input[placeholder="Instagram ID*"]').value,
    transactionId: txnId.value,
    photo: photoBase64,
    photoName: photoName
  };

  try {
    const res = await fetch("https://script.google.com/macros/s/AKfycbwa6q-C-wfcuOQtJYEpM2SLC630Gcm0A-KecmLKa27h6T3WksdECplBoihnhAnLwdiH/exec", {
      method: "POST",
      body: JSON.stringify(formData),
      headers: { "Content-Type": "application/json" },
      mode: "no-cors"
    });

    // Hide loader
    loader.style.display = "none";

    // Show success message
    successMessage.style.display = "block";

    emailjs.send("service_bezo338", "template_z5ppyei", {
      name: formData.name,
      email: formData.email,
      program: formData.program,
      message: `Hi ${formData.name}, 
      Your request for ${formData.program} has been successfully submitted. üéâ 
      We will check and share updates with you soon. üöÄ`
    })

    // Reset form
    document.getElementById("regForm").reset();
    programInput.value = formData.program;

  } catch (err) {
    loader.style.display = "none";
    console.error("Error:", err);
    alert("‚ùå Something went wrong. Try again.");
  }
});

// Close success message
closeSuccess.addEventListener("click", () => {
   window.location.href = "index.html";
});




      const backToPaymentBtn = document.getElementById("backToPaymentBtn");

      backToPaymentBtn.addEventListener("click", () => {
        formContainer.style.display = "none";
        paymentSection.style.display = "block";
      });



      // Pre-select program based on URL param
// Pre-select program based on encrypted URL param
const urlParams = new URLSearchParams(window.location.search);
const encryptedProgram = urlParams.get("p");

let programValue;

if (encryptedProgram) {
  try {
    programValue = atob(encryptedProgram); // decode from Base64
  } catch(e) {
    console.warn("Invalid program code in URL");
    programValue = "essentials"; // fallback default
  }
} else {
  programValue = "essentials"; // default
}

let optionToSelect;
if (programValue === "essentials") {
  optionToSelect = document.querySelector('.program-card input[value="299"]');
} else if (programValue === "intensive") {
  optionToSelect = document.querySelector('.program-card input[value="299"]');
}

// Select program
if (optionToSelect) {
  optionToSelect.checked = true;
  updateProgram(optionToSelect);
}




// Force the URL to your chosen ‚Äúencrypted‚Äù URL
(function() {
    const newUrl = "join.html?id=GPDhRftv6GI0IGYnIz4PZ7Y6X0dWYJRQl2cxGRDHt3oI00KW9f";
    history.replaceState(null, "", newUrl);
})();





 // Prevent right-click, but allow on input, textarea, and editable divs
    document.addEventListener('contextmenu', (event) => {
        const target = event.target;
        const allowedTags = ['INPUT', 'TEXTAREA'];
        
        if (!allowedTags.includes(target.tagName) && !target.isContentEditable) {
            event.preventDefault();
        }
    });

    document.addEventListener('keydown', (event) => {
        const target = event.target;
        const allowedTags = ['INPUT', 'TEXTAREA'];

        // Allow premium operations inside input and textarea
        if (allowedTags.includes(target.tagName) || target.isContentEditable) {
            return;
        }

        // Block F12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+U
        if (
            event.keyCode === 123 || // F12
            (event.ctrlKey && event.shiftKey && (event.keyCode === 73 || event.keyCode === 74)) || // Ctrl+Shift+I or Ctrl+Shift+J
            (event.ctrlKey && event.keyCode === 85) // Ctrl+U
        ) {
            event.preventDefault();
        }
    });



       document.querySelectorAll(".copy-btn").forEach(btn => {
  btn.addEventListener("click", () => {
    const targetId = btn.getAttribute("data-copy-target");
    const textToCopy = document.getElementById(targetId).innerText;

    navigator.clipboard.writeText(textToCopy).then(() => {
      const originalText = btn.textContent;
      btn.textContent = "Copied";
      btn.disabled = true;

      setTimeout(() => {
        btn.textContent = originalText;
        btn.disabled = false;
      }, 3000);
    }).catch(err => {
      console.error("Copy failed: ", err);
      alert("Failed to copy text.");
    });
  });
});

  </script>

</body>
</html>
